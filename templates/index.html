<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Embedded Website</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div id="banner" class="banner">
        <h2 class="header">
            <span class="welcome">Welcome! 10,000+ seed & pre-seed startups for</span>
            <span class="doom"> Doomscrolling...</span>
        </h2>
        <h6 class="subtitle">Use the arrows on the right to navigate between startups. If a company doesn't load, click "ðŸ”—" to open in a new tab</h6>
        <button class="close-button" onclick="closeBanner()">âœ–</button>
    </div>

    <div class="iframe-container">
        <iframe id="embedded-frame" src="" scrolling="yes"></iframe>
    </div>

    <div class="arrow-buttons">
        <button class="open-link-button" onclick="openInNewTab()">ðŸ”—</button>
        <button class="arrow-button up-button" onclick="scrollUp()">â–²</button>
        <button class="arrow-button down-button" onclick="scrollDown()">â–¼</button>
    </div>

    <script>
        const data = {{ data | tojson }};
        let currentIndex = -1;  // Start with an invalid index
    
        function formatURL(url) {
            if (!url.startsWith("http://") && !url.startsWith("https://")) {
                return "https://" + url;
            }
            return url;
        }
    
        function updateIframe() {
            // Generate a random index
            currentIndex = Math.floor(Math.random() * data.length);
            const iframe = document.getElementById("embedded-frame");
            iframe.src = formatURL(data[currentIndex].Website);
        }
    
        function openInNewTab() {
            const iframe = document.getElementById("embedded-frame");
            const url = iframe.src;
            if (url) {
                window.open(url, "_blank");
            } else {
                alert("No website loaded to open.");
            }
        }
    
        function skipToNext() {
            // Generate a new random index
            currentIndex = Math.floor(Math.random() * data.length);
            updateIframe();
        }
    
        function scrollUp() {
            skipToNext();  // Random selection instead of scrolling up
        }
    
        function scrollDown() {
            skipToNext();  // Random selection instead of scrolling down
        }
    
        function closeBanner() {
            document.getElementById('banner').style.display = 'none';
        }
    
        window.onload = function() {
            updateIframe();  // Load the first random company when the page loads
        };
    
        const iframe = document.getElementById("embedded-frame");
        iframe.onload = function() {
            console.log("Website loaded successfully.");
        };
    
        iframe.onerror = function() {
            console.log("Failed to load the website, skipping to the next one...");
            skipToNext();
        };
    </script>
    
</body>
</html>
